/*! jquery choice - v0.2.0 - 2013-11-22
* https://github.com/amazingSurge/jquery-choice
* Copyright (c) 2013 amazingSurge; Licensed GPL */
(function(t){"use strict";var e=t.choice=function(s,i){this.select=s,this.$select=t(s),this.$options=this.$select.find("option");var a={};0!==this.$options.length&&(a.status={},a.value=[],a.multiple=this.$select.prop("multiple"),t.each(this.$options,function(e,s){a.status[t(s).attr("value")]={},a.status[t(s).attr("value")].text=t(s).text(),t(s).prop("selected")&&a.value.push(t(s).attr("value"))})),this.options=t.extend({},e.defaults,i,a),this.namespace=this.options.namespace,this.status=this.options.status,this.classes={selected:this.namespace+"-selected",disabled:this.namespace+"-disabled",skin:this.namespace+"_"+this.options.skin},this.value=[],this.disabled=!1,this.init()};e.prototype={constuctor:e,init:function(){var e=this,s='<li><span class="'+e.namespace+'-text"></span></li>';this.$select.css({display:"none"}),this.$wrap=t("<ul></ul>"),this.$wrap.addClass(this.namespace),this.options.skin&&this.$wrap.addClass(this.classes.skin),t.each(this.status,function(i,a){var c=t(s).data("value",i);"object"==typeof a?(a.icon&&t("<i></i>").addClass(a.icon).appendTo(c),a.text&&c.find("span").text(a.text)):c.find("span").text(a.text),t.each(e.value,function(t,s){s===i&&c.addClass(e.classes.selected)}),e.$wrap.append(c)}),this.$select.after(this.$wrap),this.$wrap.find("a").on("click.choice",function(t){t.preventDefault()}),this.options.multiple===!0?(this.$wrap.delegate("li","click.choice touchstart.choice",function(){return t(this).hasClass(e.classes.selected)?(e.set.call(e,t(this).data("value"),"unselected"),!1):(e.set.call(e,t(this).data("value"),"selected"),!1)}),t.each(this.options.value,function(t,s){e.set.call(e,s,"selected")})):(this.$wrap.delegate("li","click.choice touchstart.choice",function(){e.set(t(this).data("value"),"selected")}),this.set(this.options.value[0],"selected")),this.$select.trigger("choice::ready",this)},set:function(e,s){var i,a,c=t.inArray(e,this.value);if(!this.disabled)if(this.options.multiple===!0)t.each(this.$options,function(s,a){t(a).attr("value")===e&&(i=t(a))}),t.each(this.$wrap.find("li"),function(s,i){t(i).data("value")===e&&(a=t(i))}),"selected"===s?(this.value.push(e),a.addClass(this.classes.selected),i.prop("selected",!0)):(this.value.splice(c,1),a.removeClass(this.classes.selected),i.prop("selected",!1)),this.$select.trigger("choice::change",this),"function"==typeof this.options.onChange&&this.options.onChange.call(this,this.value);else{if(e===this.value[0])return!1;if("unselected"===s)return!1;var l=this;t.each(this.$options,function(s,i){t(i).attr("value")===e?t(i).prop("selected",!0):t(i).prop("selected",!1)}),t.each(this.$wrap.find("li"),function(s,i){t(i).data("value")===e?(t(i).addClass(l.classes.selected),l.value[0]=e):t(i).removeClass(l.classes.selected)}),this.$select.trigger("choice::change",this),"function"==typeof this.options.onChange&&this.options.onChange.call(this,this.value)}},val:function(t,e){return t&&e?(this.set(t,e),void 0):this.value},enable:function(){return this.disabled=!1,this.$wrap.removeClass(this.classes.disabled),this},disable:function(){return this.disabled=!0,this.$wrap.addClass(this.classes.disabled),this},destroy:function(){this.$wrap.undelegate(".choice"),this.$wrap.find("a").off(".choice"),this.$wrap.remove()}},e.defaults={skin:null,multiple:!1,value:["default"],namespace:"choice"},t.fn.choice=function(s){if("string"==typeof s){var i=s,a=arguments.length>1?Array.prototype.slice.call(arguments,1):void 0;return this.each(function(){var e=t.data(this,"choice");"function"==typeof e[i]&&e[i].apply(e,a)})}return this.each(function(){t.data(this,"choice")||t.data(this,"choice",new e(this,s))})}})(jQuery);